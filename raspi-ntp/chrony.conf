# Minimalna konfiguracja chrony dla GPS (NMEA + PPS) bez Internetu

# Ustaw strefę skoków sekundowych z lokalnego systemu
leapsectz right/UTC

# Gdy czas odjechał, wykonaj szybkie kroki
makestep 1.0 3

# Utrzymuj RTC w synchronizacji z systemem
rtcsync

# Offline: brak zewnętrznych serwerów (możesz dodać własne, jeśli pojawi się Internet)
# pool 0.pool.ntp.org iburst

# GPS przez gpsd (SHM). Unikamy kolizji dostępu do portu szeregowego.
# gpsd publikuje stempel czasu do segmentów SHM 0/1.
refclock SHM 0 refid GPS
# (opcjonalnie) drugi segment z lepszą precyzją z gpsd
# refclock SHM 1 refid GPS1

# PPS z GPIO (opcjonalnie). Wymaga /dev/pps0 i "lock GPS" do wyznaczenia sekundy.
# Jeśli brak PPS, zakomentuj poniższą linię.
refclock PPS /dev/pps0 lock GPS refid PPS prefer

# Zezwól klientom w twojej sieci (dostosuj zakresy)
allow 192.168.0.0/16
allow 10.0.0.0/8
allow 172.16.0.0/12

# Gdy nie ma żadnych źródeł, zachowuj się jak lokalny lider (stratum 10)
local stratum 10

# Logi
logdir /var/log/chrony
